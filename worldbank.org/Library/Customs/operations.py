import datetime
import time
from tkinter import messagebox
import tkinter
import re

class Operations:
    # cuts the string as per given data length
    def cutString(data,datalen)->str:
        data = str(data)
        if len(data)<datalen:
            return data
        return data[0:datalen-3] + "..."    
    # converts DD-MM-YYYY or DD/MM/YYYY format to YYYY-MM-DD
    def convertDDMMYYYYtoYYYYMMDD(data)->str:
        if(data==""):
            return ""
        data = str(data).replace("/","-")
        data = data.split("-")
        day = data[0] if len(data[0]) == 2 else "0"+data[0]
        month = data[1] if len(data[1]) == 2 else "0"+data[1]
        year = data[2]
        return str(f"{year}-{month}-{day}")

    # converts YYYY-MM-DD or YYYY/MM/DD format to DD-MM-YYYY
    def convertYYYYMMDDtoDDMMYYYY(data)->str:
        if(data==""):
            return ""
        data = str(data).replace("/","-")
        data = data.split("-")
        day = data[2] if len(data[2]) == 2 else "0"+data[0]
        month = data[1] if len(data[1]) == 2 else "0"+data[1]
        year = data[0]
        return str(f"{day}-{month}-{year}")

    #holds the system for given period of time in seconds
    def holdProcess(timeInSec):
        time.sleep(timeInSec)
    
    # get The Current Date in DD-MM-YYYY format bydefault
    def getCurrentDate(format = "dmy"):
        if(format == "dmy"):
            return datetime.datetime.today().strftime("%d-%m-%Y")
        return datetime.datetime.today().strftime("%Y-%m-%d")

    # get The Current Date in YYYY-MM-DD format bydefault
    def getCurrentDateTime(format ="ymd"):
        if(format == "ymd"):
            return datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        return datetime.datetime.now().strftime("%d-%m-%Y %H:%M:%S")
    
    #convert  YYYY-MM-DD string format to  YYYY-MM-DD date formate
    def convertStringToDate(strDate):
        strDate = str(strDate).replace("/","-")
        return datetime.datetime.strptime(strDate,"%Y-%m-%d")

    def getCurrentDateTimeForFileName():
        return datetime.datetime.now().strftime("%Y%m%d%H%M%S%f")

    #pass true to isExit 
    def alertMessage(message="",isExit=False):
        messagebox.showinfo("Please Contact System Admin\n",message)
        if(isExit):
            exit(0)

    def removeHtmlTags(text):
        text = str(text).strip()
        if(text==""):
            return ""
        text = text.replace("<br>","||br||").replace("<br/>","||br||").replace("<BR>","||br||").replace("<BR/>","||br||")
        return re.sub(re.compile('<.*?>'), '', text).replace("||br||","<br/>")

    def removeSpecialCharacters(text):
        text = str(text).strip()
        if(text==""):
            return ""
        text = text.replace("√¢‚Ç¨‚Ñ¢", "-").replace("√¢‚Ç¨‚Äú", "-").replace("√¢‚Ç¨", "-").replace("√¢‚Ç¨‚Äú", "-")
        text = text.replace("¬¢", "c")
        text = text.replace("¬£", "¬£")
        text = text.replace("¬§", "")
        text = text.replace("¬•", "")
        text = text.replace("¬¶", "")
        text = text.replace("¬ß", "¬ß")
        text = text.replace("¬®", "")
        text = text.replace("¬©", "(c)")
        text = text.replace("¬™", "")
        text = text.replace("¬´", "<")
        text = text.replace("¬¨", "-")
        text = text.replace("¬≠", "-")
        text = text.replace("¬Æ", "(r)")
        text = text.replace("¬Ø", "-")
        text = text.replace("¬∞", "")
        text = text.replace("¬±", "+/-")
        text = text.replace("¬≤", "2")
        text = text.replace("¬¥", "'")
        text = text.replace("¬µ", "y")
        text = text.replace("¬∂", "P")
        text = text.replace("¬∑", ".")
        text = text.replace("¬∏", "")
        text = text.replace("¬π", "1")
        text = text.replace("¬∫", "")
        text = text.replace("¬ª", ">")
        text = text.replace("¬º", "1/4")
        text = text.replace("¬Ω", "1/2")
        text = text.replace("¬æ", "3/4")
        text = text.replace("¬ø", "?")
        text = text.replace("√Ä", "A")
        text = text.replace("√Å", "A")
        text = text.replace("√Ç", "A")
        text = text.replace("√É", "A")
        text = text.replace("√Ñ", "Ae")
        text = text.replace("√Ö", "A")
        text = text.replace("√Ü", "Ae")
        text = text.replace("√á", "C")
        text = text.replace("√à", "E")
        text = text.replace("√â", "E")
        text = text.replace("√ä", "E")
        text = text.replace("√ã", "E")
        text = text.replace("√å", "I")
        text = text.replace("√ç", "I")
        text = text.replace("√é", "I")
        text = text.replace("√è", "I")
        text = text.replace("√ê", "D")
        text = text.replace("√ë", "N")
        text = text.replace("√í", "O")
        text = text.replace("√ì", "O")
        text = text.replace("√î", "O")
        text = text.replace("√ï", "O")
        text = text.replace("√ñ", "Oe")
        text = text.replace("√ó", "x")
        text = text.replace("√ò", "0")
        text = text.replace("√ô", "U")
        text = text.replace("√ö", "U")
        text = text.replace("√õ", "U")
        text = text.replace("√ú", "Ue")
        text = text.replace("√ù", "Y")
        text = text.replace("√û", "p")
        text = text.replace("√ü", "ss")
        text = text.replace("√†", "a")
        text = text.replace("√°", "a")
        text = text.replace("√¢", "a")
        text = text.replace("√£", "a")
        text = text.replace("√§", "ae")
        text = text.replace("√•", "a")
        text = text.replace("√°", "a")
        text = text.replace("√≥", "o")
        text = text.replace("√¶", "ae")
        text = text.replace("√ß", "c")
        text = text.replace("√®", "e")
        text = text.replace("√©", "e")
        text = text.replace("√™", "e")
        text = text.replace("√´", "e")
        text = text.replace("√¨", "i")
        text = text.replace("√≠", "i")
        text = text.replace("√Æ", "i")
        text = text.replace("√Ø", "i")
        text = text.replace("√∞", "a")
        text = text.replace("√±", "n")
        text = text.replace("√≤", "o")
        text = text.replace("√≥", "o")
        text = text.replace("√¥", "o")
        text = text.replace("√µ", "o")
        text = text.replace("√∂", "oe")
        text = text.replace("√≥", "o")
        text = text.replace("√∑", "/")
        text = text.replace("√∏", "0")
        text = text.replace("√π", "u")
        text = text.replace("√∫", "u")
        text = text.replace("√ª", "u")
        text = text.replace("√º", "ue")
        text = text.replace("√Ω", "y")
        text = text.replace("√æ", "p")
        text = text.replace("√ø", "y")
        text = text.replace("‚Äì", " ")
        text = text.replace("‚Äú", "\"")
        text = text.replace("‚Äù", "\"")
        text = text.replace("‚Äô", "\'")
        text = text.replace("‚Äô", "")
        text = text.replace("&ndash;", "‚Äì")
        text = text.replace("&mdash;", "‚Äî")
        text = text.replace("&iexcl;", "¬°")
        text = text.replace("&iquest;", "¬ø")
        text = text.replace("&quot;", "\"")
        text = text.replace("&ldquo;", "‚Äú")
        text = text.replace("&rdquo;", "‚Äù")
        text = text.replace("&lsquo;", "‚Äò")
        text = text.replace("&rsquo;", "‚Äô")
        text = text.replace("&laquo;", "¬´")
        text = text.replace("&raquo;", "¬ª")
        text = text.replace("&nbsp;", "¬†¬†")
        text = text.replace("&amp;", "&")
        text = text.replace("&cent;", "¬¢")
        text = text.replace("&copy;", "¬©")
        text = text.replace("&divide;", "√∑")
        text = text.replace("&gt;", ">")
        text = text.replace("&lt;", "<")
        text = text.replace("&micro;", "¬µ")
        text = text.replace("&middot;", "¬∑")
        text = text.replace("&para;", "¬∂")
        text = text.replace("&plusmn;", "¬±")
        text = text.replace("&euro;", "‚Ç¨")
        text = text.replace("&pound;", "¬£")
        text = text.replace("&reg;", "¬Æ")
        text = text.replace("&sect;", "¬ß")
        text = text.replace("&trade;", "‚Ñ¢")
        text = text.replace("&yen;", "¬•")
        text = text.replace("&deg;", "¬∞")
        text = text.replace("&aacute;", "√°")
        text = text.replace("&Aacute;", "√Å")
        text = text.replace("&agrave;", "√†")
        text = text.replace("&Agrave;", "√Ä")
        text = text.replace("&acirc;", "√¢")
        text = text.replace("&Acirc;", "√Ç")
        text = text.replace("&aring;", "√•")
        text = text.replace("&Aring;", "√Ö")
        text = text.replace("&atilde;", "√£")
        text = text.replace("&Atilde;", "√É")
        text = text.replace("&auml;", "√§")
        text = text.replace("&Auml;", "√Ñ")
        text = text.replace("&aelig;", "√¶")
        text = text.replace("&AElig;", "√Ü")
        text = text.replace("&ccedil;", "√ß")
        text = text.replace("&Ccedil;", "√á")
        text = text.replace("&eacute;", "√©")
        text = text.replace("&Eacute;", "√â")
        text = text.replace("&egrave;", "√®")
        text = text.replace("&Egrave;", "√à")
        text = text.replace("&ecirc;", "√™")
        text = text.replace("&Ecirc;", "√ä")
        text = text.replace("&euml;", "√´")
        text = text.replace("&Euml;", "√ã")
        text = text.replace("&iacute;", "√≠")
        text = text.replace("&Iacute;", "√ç")
        text = text.replace("&igrave;", "√¨")
        text = text.replace("&Igrave;", "√å")
        text = text.replace("&icirc;", "√Æ")
        text = text.replace("&Icirc;", "√é")
        text = text.replace("&iuml;", "√Ø")
        text = text.replace("&Iuml;", "√è")
        text = text.replace("&ntilde;", "√±")
        text = text.replace("&Ntilde;", "√ë")
        text = text.replace("&oacute;", "√≥")
        text = text.replace("&Oacute;", "√ì")
        text = text.replace("&ograve;", "√≤")
        text = text.replace("&Ograve;", "√í")
        text = text.replace("&ocirc;", "√¥")
        text = text.replace("&Ocirc;", "√î")
        text = text.replace("&oslash;", "√∏")
        text = text.replace("&Oslash;", "√ò")
        text = text.replace("&otilde;", "√µ")
        text = text.replace("&Otilde;", "√ï")
        text = text.replace("&ouml;", "√∂")
        text = text.replace("&Ouml;", "√ñ")
        text = text.replace("&szlig;", "√ü")
        text = text.replace("&uacute;", "√∫")
        text = text.replace("&Uacute;", "√ö")
        text = text.replace("&ugrave;", "√π")
        text = text.replace("&Ugrave;", "√ô")
        text = text.replace("&ucirc;", "√ª")
        text = text.replace("&Ucirc;", "√õ")
        text = text.replace("&uuml;", "√º")
        text = text.replace("&Uuml;", "√ú")
        text = text.replace("&yuml;", "√ø")
        text = text.replace("¬°", ";")
        text = text.replace("√É¬≠", "i")
        text = text.replace("√É¬≥", "o")
        text = text.replace("√É¬∫", "u")
        text = text.replace("√¢‚Ç¨‚Ñ¢", "-")
        text = text.replace("√¢‚Ç¨‚Äú", "-")
        text = text.replace("√¢‚Ç¨", "-")
        text = text.replace("√¢‚Ç¨‚Äú", "-")
        text = text.replace("¬¢", "c")
        text = text.replace("¬£", "¬£")
        text = text.replace("¬§", "")
        text = text.replace("¬•", "")
        text = text.replace("¬¶", "")
        text = text.replace("¬ß", "¬ß")
        text = text.replace("¬®", "")
        text = text.replace("¬©", "(c)")
        text = text.replace("¬™", "")
        text = text.replace("¬´", "<")
        text = text.replace("¬¨", "-")
        text = text.replace("¬≠", "-")
        text = text.replace("¬Æ", "(r)")
        text = text.replace("¬Ø", "-")
        text = text.replace("¬∞", "")
        text = text.replace("¬±", "+/-")
        text = text.replace("¬≤", "2")
        text = text.replace("¬≥", "3")
        text = text.replace("¬¥", "'")
        text = text.replace("¬µ", "y")
        text = text.replace("¬∂", "P")
        text = text.replace("¬∑", ".")
        text = text.replace("¬∏", "")
        text = text.replace("¬π", "1")
        text = text.replace("¬∫", "")
        text = text.replace("¬ª", ">")
        text = text.replace("¬º", "1/4")
        text = text.replace("¬Ω", "1/2")
        text = text.replace("¬æ", "3/4")
        text = text.replace("¬ø", "?")
        text = text.replace("√Ä", "A")
        text = text.replace("√Å", "A")
        text = text.replace("√Ç", "A")
        text = text.replace("√É", "A")
        text = text.replace("√Ñ", "Ae")
        text = text.replace("√Ö", "A")
        text = text.replace("√Ü", "Ae")
        text = text.replace("√á", "C")
        text = text.replace("√à", "E")
        text = text.replace("√â", "E")
        text = text.replace("√ä", "E")
        text = text.replace("√ã", "E")
        text = text.replace("√å", "I")
        text = text.replace("√ç", "I")
        text = text.replace("√é", "I")
        text = text.replace("√è", "I")
        text = text.replace("√ê", "D")
        text = text.replace("√ë", "N")
        text = text.replace("√í", "O")
        text = text.replace("√ì", "O")
        text = text.replace("√î", "O")
        text = text.replace("√ï", "O")
        text = text.replace("√ñ", "Oe")
        text = text.replace("√ó", "x")
        text = text.replace("√ò", "0")
        text = text.replace("√ô", "U")
        text = text.replace("√ö", "U")
        text = text.replace("√õ", "U")
        text = text.replace("√ú", "Ue")
        text = text.replace("√ù", "Y")
        text = text.replace("√û", "p")
        text = text.replace("√ü", "ss")
        text = text.replace("√†", "a")
        text = text.replace("√°", "a")
        text = text.replace("√¢", "a")
        text = text.replace("√£", "a")
        text = text.replace("√§", "ae")
        text = text.replace("√•", "a")
        text = text.replace("√¶", "ae")
        text = text.replace("√ß", "c")
        text = text.replace("√®", "e")
        text = text.replace("√©", "e")
        text = text.replace("√™", "e")
        text = text.replace("√´", "e")
        text = text.replace("√¨", "i")
        text = text.replace("√≠", "i")
        text = text.replace("√Æ", "i")
        text = text.replace("√Ø", "i")
        text = text.replace("√∞", "a")
        text = text.replace("√±", "n")
        text = text.replace("√≤", "o")
        text = text.replace("√≥", "o")
        text = text.replace("√¥", "o")
        text = text.replace("√µ", "o")
        text = text.replace("√∂", "oe")
        text = text.replace("√≥", "o")
        text = text.replace("√∑", "/")
        text = text.replace("√∏", "0")
        text = text.replace("√π", "u")
        text = text.replace("√∫", "u")
        text = text.replace("√ª", "u")
        text = text.replace("√º", "ue")
        text = text.replace("√Ω", "y")
        text = text.replace("√æ", "p")
        text = text.replace("√ø", "y")
        text = text.replace("‚Äì", " ")
        text = text.replace("‚Äú", "\"")
        text = text.replace("‚Äù", "\"")
        text = text.replace("‚Äô", "\'")
        text = text.replace("‚Äô", "")
        text = text.replace("ÙÄÉç", "")
        text = text.replace("üìç", "")
        return text
        
            